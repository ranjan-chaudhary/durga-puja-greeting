<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Durga Puja Greeting</title>
  <link href="https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi:wght@400;700&family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: url("https://i.pinimg.com/736x/e3/a6/68/e3a668f6dab2ee22fad77ab6552e38ce.jpg") no-repeat;
      background-size: cover;
      background-position: center 40%;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: 'Poppins', sans-serif;
      overflow: hidden;
    }

    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background:
        radial-gradient(60% 60% at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.55) 100%),
        linear-gradient(to bottom, rgba(0,0,0,0.35), rgba(0,0,0,0.6));
      z-index: 1;
    }

    .greeting {
      text-align: center;
      color: #fff;
      z-index: 2;
      animation: fadeIn 3s ease-in-out;
      padding: 0 16px;
    }

    .greeting h1 {
      font-family: 'Tiro Devanagari Hindi', serif;
      font-size: 3.8em;
      line-height: 1.1;
      letter-spacing: 2px;
      text-shadow: 0 0 0 #000,
                   0 0 12px rgba(255,215,0,0.8),
                   0 0 32px rgba(255,165,0,0.65);
      -webkit-text-stroke: 1px rgba(0,0,0,0.25);
      animation: zoomIn 5s infinite alternate ease-in-out;
    }

    .greeting p {
      font-size: 1.5em;
      margin-top: 20px;
      animation: glow 2s infinite alternate;
    }

    .subtitle-hi {
      margin-top: 10px;
      font-size: 1.1em;
      opacity: 0.9;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes zoomIn {
      from { transform: scale(0.9); }
      to { transform: scale(1.1); }
    }

    @keyframes glow {
      from { text-shadow: 0 0 10px gold; }
      to { text-shadow: 0 0 20px #ff0, 0 0 30px red; }
    }

    /* Floating diyas */
    .diya {
      position: absolute;
      bottom: 15px;
      width: 70px;
      animation: float 5s infinite ease-in-out;
      z-index: 2;
    }

    .diya:nth-child(3) { left: 20%; animation-delay: 0s; }
    .diya:nth-child(4) { left: 50%; animation-delay: 2s; }
    .diya:nth-child(5) { left: 80%; animation-delay: 4s; }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    /* Floating flowers (falling effect) */
    .flower {
      position: absolute;
      top: -50px;
      width: 40px;
      animation: fall linear infinite;
      z-index: 2;
    }

    @keyframes fall {
      0% { transform: translateY(-50px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }

    /* Controls */
    .controls {
      position: fixed;
      top: 14px;
      right: 14px;
      z-index: 3;
      display: flex;
      gap: 10px;
    }
    .btn {
      border: 1px solid rgba(255,255,255,0.6);
      background: rgba(0,0,0,0.35);
      color: #fff;
      padding: 8px 12px;
      border-radius: 999px;
      cursor: pointer;
      backdrop-filter: blur(4px);
      transition: transform .2s ease, background .2s ease;
      font-weight: 600;
    }
    .btn:hover { transform: translateY(-2px); background: rgba(255,255,255,0.08); }
    .input { display:none; }

    /* Branding */
    .logo {
      position: fixed;
      top: 14px; left: 14px;
      width: 72px; height: 72px; object-fit: contain;
      z-index: 3;
      background: rgba(255,255,255,0.85);
      border-radius: 12px;
      padding: 6px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
    }
    .credit { display: none; }

    /* Celebration burst */
    .burst {
      position: fixed;
      left: 50%; top: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
      z-index: 4;
      font-size: 26px;
      animation: burst 900ms ease-out forwards;
    }
    @keyframes burst {
      from { opacity: 1; transform: translate(-50%, -50%) scale(0.6); }
      to   { opacity: 0; transform: translate(-50%, -60%) scale(2.2); }
    }

    /* Sound gate */
    .sound-gate {
      position: fixed;
      left: 50%; bottom: 18px;
      transform: translateX(-50%);
      z-index: 4;
      background: rgba(0,0,0,0.55);
      color: #fff;
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.35);
      display: none;
      gap: 10px;
      align-items: center;
    }

    @media (max-height: 640px) {
      .greeting h1 { font-size: 3.2em; }
      .diya { width: 56px; }
    }
  </style>
</head>
<body>
  <div class="overlay"></div>

  <div class="greeting">
    <h1>‚ú® ‡§∂‡•Å‡§≠ ‡§¶‡•Å‡§∞‡•ç‡§ó‡§æ ‡§™‡•Ç‡§ú‡§æ ‚ú®</h1>
    <p class="subtitle-hi">‡§Æ‡§æ‡§Å ‡§¶‡•Å‡§∞‡•ç‡§ó‡§æ ‡§Ü‡§™‡§ï‡•á ‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§∏‡•Å‡§ñ, ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§î‡§∞ ‡§∏‡§Æ‡•É‡§¶‡•ç‡§ß‡§ø ‡§≤‡§æ‡§è‡§Å‡•§</p>
    <p>May Maa Durga bring happiness, health, and prosperity to your life!</p>
    <p id="countdown" style="margin-top:10px;font-weight:600"></p>
  </div>

  <img id="collegeLogo" class="logo" alt="College Logo" />

  <div class="controls">
    <button class="btn" id="celebrateBtn">Celebrate ‚ú®</button>
    <button class="btn" id="audioBtn">Mute üîä</button>
    <button class="btn" id="shareBtn">Share üì§</button>
    <button class="btn" id="downloadBtn">Download üì∏</button>
  </div>

  <div class="sound-gate" id="soundGate">
    Tap to enable sound
    <button class="btn" id="enableSoundBtn">Enable üîä</button>
  </div>

  <!-- diyas -->
  <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1fa94.svg" class="diya" alt="Diya">
  <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1fa94.svg" class="diya" alt="Diya">
  <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1fa94.svg" class="diya" alt="Diya">

  <!-- falling flowers -->
  <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f33a.svg" class="flower" style="left:10%; animation-duration: 8s; animation-delay: 0s;">
  <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f33a.svg" class="flower" style="left:30%; animation-duration: 10s; animation-delay: 2s;">
  <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f33a.svg" class="flower" style="left:50%; animation-duration: 7s; animation-delay: 1s;">
  <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f33a.svg" class="flower" style="left:70%; animation-duration: 9s; animation-delay: 3s;">
  <img src="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f33a.svg" class="flower" style="left:90%; animation-duration: 11s; animation-delay: 4s;">

  <!-- background music -->
  <audio autoplay loop id="bgm" preload="auto" playsinline>
    <source src="durga-puja-dhak-sound-125241.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <script>
    const audio = document.getElementById('bgm');
    audio.volume = 0.6;
    const audioBtn = document.getElementById('audioBtn');
    const celebrateBtn = document.getElementById('celebrateBtn');
    const soundGate = document.getElementById('soundGate');
    const enableSoundBtn = document.getElementById('enableSoundBtn');
    const nameInput = null;
    const shareBtn = document.getElementById('shareBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const countdownEl = document.getElementById('countdown');
    const collegeLogo = document.getElementById('collegeLogo');

    let audioStarted = false;
    async function tryStartAudio() {
      if (audioStarted) return;
      try {
        await audio.play();
        audioStarted = true;
        soundGate.style.display = 'none';
      } catch (e) {
        soundGate.style.display = 'flex';
      }
    }

    // Start on first user interaction
    window.addEventListener('click', tryStartAudio, { once: true });
    window.addEventListener('touchstart', tryStartAudio, { once: true });
    enableSoundBtn && enableSoundBtn.addEventListener('click', tryStartAudio);

    audioBtn.addEventListener('click', () => {
      if (audio.muted) {
        audio.muted = false;
        audioBtn.textContent = 'Mute üîä';
      } else {
        audio.muted = true;
        audioBtn.textContent = 'Unmute üîá';
      }
    });

    function fireBurst() {
      const emojis = ['üéâ','‚ú®','ü™î','üå∏','üåº','ü™î','‚ú®'];
      const burst = document.createElement('div');
      burst.className = 'burst';
      burst.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      document.body.appendChild(burst);
      setTimeout(() => burst.remove(), 900);
    }

    celebrateBtn.addEventListener('click', () => {
      tryStartAudio();
      for (let i = 0; i < 12; i++) {
        setTimeout(fireBurst, i * 60);
      }
    });

    // Personalize greeting with name
    const titleEl = document.querySelector('.greeting h1');
    // Fixed title (no personalization)
    titleEl.textContent = '‚ú® ‡§∂‡•Å‡§≠ ‡§¶‡•Å‡§∞‡•ç‡§ó‡§æ ‡§™‡•Ç‡§ú‡§æ ‚ú®';

    // Countdown to start of Durga Puja: Sep 22 each year
    function updateCountdown() {
      const target = new Date(new Date().getFullYear(), 8, 22, 0, 0, 0); // Sep 22 (month 8)
      const now = new Date();
      if (now > target) target.setFullYear(target.getFullYear() + 1);
      const diff = target - now;
      const d = Math.floor(diff / (1000*60*60*24));
      const h = Math.floor((diff / (1000*60*60)) % 24);
      const m = Math.floor((diff / (1000*60)) % 60);
      const s = Math.floor((diff / 1000) % 60);
      countdownEl.textContent = `‡§¶‡•Å‡§∞‡•ç‡§ó‡§æ ‡§™‡•Ç‡§ú‡§æ ‡§Ü‡§∞‡§Æ‡•ç‡§≠ ‡§§‡§ï: ${d} ‡§¶‡§ø‡§® ${h} ‡§ò‡§Ç ${m} ‡§Æ‡§ø ${s} ‡§∏‡•á`;
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();

    // Share and Download
    shareBtn.addEventListener('click', async () => {
      tryStartAudio();
      const text = document.querySelector('.greeting h1').textContent + '\n' + document.querySelector('.subtitle-hi').textContent;
      if (navigator.share) {
        await navigator.share({ title: 'Durga Puja Greeting', text, url: location.href });
      } else {
        alert('Sharing not supported. You can download an image instead.');
      }
    });

    downloadBtn.addEventListener('click', async () => {
      tryStartAudio();
      const node = document.body;
      const canvas = await html2canvas(node, { backgroundColor: null, ignoreElements: (el) => el.classList && (el.classList.contains('controls') || el.classList.contains('sound-gate')) });
      const link = document.createElement('a');
      link.download = 'durga-puja-greeting.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    });

    // Try multiple possible logo filenames; use the first that loads
    (function loadLogo() {
      const candidates = [
        'https://static.ambitionbox.com/assets/v2/images/rs:fit:200:200:false:false/bG9jYWw6Ly8vbG9nb3Mvb3JpZ2luYWxzL2NpbWFnZS1jb2xsZWdlLmpwZw.webp',
        'cimage.png','cimage.jpg','cimage.jpeg','cimage.webp',
        'logo.png','logo.jpg','logo.jpeg','logo.webp'
      ];
      let index = 0;
      function tryNext() {
        if (index >= candidates.length) { return; }
        const test = new Image();
        const src = candidates[index++];
        test.onload = () => { collegeLogo.src = src; };
        test.onerror = tryNext;
        test.src = src;
      }
      tryNext();
    })();
  </script>
</body>
</html>
